/*
 * This file was generated by the Gradle 'init' task.
 *
 * This is a general purpose Gradle build.
 * Learn more about Gradle by exploring our samples at https://docs.gradle.org/7.5.1/samples
 * This project uses @Incubating APIs which are subject to change.
 */

plugins {
    id 'war'
    id "org.gretty" version "4.0.3"
    id "org.sonarqube" version "3.0"
    id "net.foragerr.jmeter" version "1.0.5-2.13"
}

repositories {
    mavenCentral()
}

dependencies {
    implementation files('lib/derby.jar')
    implementation files('lib/servlet-api.jar')
    
    providedCompile 'jakarta.platform:jakarta.jakartaee-api:9.0.0'
	
	implementation 'org.glassfish.web:jakarta.servlet.jsp.jstl:2.0.0'
	implementation 'jakarta.servlet.jsp.jstl:jakarta.servlet.jsp.jstl-api:2.0.0'
    implementation 'org.mariadb.jdbc:mariadb-java-client:2.1.2'

    testImplementation 'org.jbehave:jbehave-core:4.8.3'
    testImplementation 'org.jbehave.site:jbehave-site-resources:3.3.1'
    testImplementation 'com.github.valfirst:jbehave-junit-runner:2.3.0'
    
    testImplementation 'org.junit.jupiter:junit-jupiter-api:5.8.1'
    testRuntimeOnly 'org.junit.jupiter:junit-jupiter-engine:5.8.1'
}

task copyJBehaveFilesToExpectedLocation(type: Copy) {
    from 'target/jbehave/view'
    from('src/test/resources/')
    into 'build/reports/jbehave'
}

test {
    useJUnitPlatform()
    include '*Test.class'
	include '**/*Test.class'
	include '**/*Tests.class'

    dependsOn cleanTest
    testLogging.showStandardStreams = true
    finalizedBy copyJBehaveFilesToExpectedLocation
    testLogging {
        events "passed", "skipped", "failed"
    }
}

gretty {
    httpPort= 8081
    contextPath="/"
}

sonarqube {
    properties {
        property "sonar.sourceEncoding", "UTF-8"
        property "sonar.junit.reportPaths","build/test-results/test/"
    }
}
